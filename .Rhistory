)
}
SERV_DATA=SERV_DATA %>%
mutate(
HEI2015_TOTALFRT = HEI2015_HEALTHY1(TOTALFRT_SERV, HEI2015_MIN_TOTALFRT_SERV, HEI2015_MAX_TOTALFRT_SERV),
HEI2015_FRT = HEI2015_HEALTHY1(FRT_SERV, HEI2015_MIN_FRT_SERV, HEI2015_MAX_FRT_SERV),
HEI2015_VEG = HEI2015_HEALTHY1(VEG_SERV, HEI2015_MIN_VEG_SERV, HEI2015_MAX_VEG_SERV),
HEI2015_GREENNBEAN = HEI2015_HEALTHY1(GREENNBEAN_SERV, HEI2015_MIN_GREENNBEAN_SERV, HEI2015_MAX_GREENNBEAN_SERV),
HEI2015_TOTALPRO = HEI2015_HEALTHY1(TOTALPRO_SERV, HEI2015_MIN_TOTALPRO_SERV, HEI2015_MAX_TOTALPRO_SERV),
HEI2015_SEAPLANTPRO = HEI2015_HEALTHY1(SEAPLANTPRO_SERV, HEI2015_MIN_SEAPLANTPRO_SERV, HEI2015_MAX_SEAPLANTPRO_SERV),
HEI2015_WHOLEGRAIN = HEI2015_HEALTHY2(WHOLEGRAIN_SERV, HEI2015_MIN_WHOLEGRAIN_SERV, HEI2015_MAX_WHOLEGRAIN_SERV),
HEI2015_DAIRY = HEI2015_HEALTHY2(DAIRY_SERV, HEI2015_MIN_DAIRY_SERV, HEI2015_MAX_DAIRY_SERV),
HEI2015_FATTYACID = HEI2015_HEALTHY2(FATTYACID_SERV, HEI2015_MIN_FATTYACID_SERV, HEI2015_MAX_FATTYACID_SERV),
HEI2015_REFINEDGRAIN = HEI2015_UNHEALTHY(REFINEDGRAIN_SERV, HEI2015_MIN_REFINEDGRAIN_SERV, HEI2015_MAX_REFINEDGRAIN_SERV),
HEI2015_SODIUM = HEI2015_UNHEALTHY(SODIUM_SERV, HEI2015_MIN_SODIUM_SERV, HEI2015_MAX_SODIUM_SERV),
HEI2015_ADDEDSUGAR = HEI2015_UNHEALTHY(ADDEDSUGAR_SERV, HEI2015_MIN_ADDEDSUGAR_SERV, HEI2015_MAX_ADDEDSUGAR_SERV),
HEI2015_SATFAT = HEI2015_UNHEALTHY(SATFAT_SERV, HEI2015_MIN_SATFAT_SERV, HEI2015_MAX_SATFAT_SERV),
HEI2015_ALL= HEI2015_TOTALFRT + HEI2015_FRT + HEI2015_VEG + HEI2015_GREENNBEAN +
HEI2015_TOTALPRO + HEI2015_SEAPLANTPRO + HEI2015_WHOLEGRAIN + HEI2015_DAIRY +
HEI2015_FATTYACID + HEI2015_REFINEDGRAIN + HEI2015_SODIUM + HEI2015_ADDEDSUGAR +
HEI2015_SATFAT
)
for(i in 1:length(TOTALKCAL)){
if (TOTALKCAL[i] == 0){
HEI2015_TOTALFRT[i] = 0
HEI2015_FRT[i] = 0
HEI2015_VEG[i] = 0
HEI2015_GREENNBEAN[i] = 0
HEI2015_TOTALPRO[i] = 0
HEI2015_SEAPLANTPRO[i] = 0
HEI2015_WHOLEGRAIN[i] = 0
HEI2015_DAIRY[i] = 0
HEI2015_FATTYACID[i] = 0
HEI2015_REFINEDGRAIN[i] = 0
HEI2015_ADDEDSUGAR[i] = 0
HEI2015_ALL[i] = 0
}
}
SERV_DATA %>%
select(RESPONDENTID, HEI2015_ALL, HEI2015_TOTALFRT, HEI2015_FRT, HEI2015_VEG, HEI2015_GREENNBEAN,
HEI2015_TOTALPRO, HEI2015_SEAPLANTPRO, HEI2015_WHOLEGRAIN, HEI2015_DAIRY,
HEI2015_FATTYACID, HEI2015_REFINEDGRAIN, HEI2015_SODIUM, HEI2015_ADDEDSUGAR,
HEI2015_SATFAT)
}
#Import data
raw_data_path <- "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Data/Dietary data/data-2022-05-03-16-48-28-rand-1807/diet-raw-and-results_cleaned.csv"
raw_data_and_result <- fread(raw_data_path)
DASH_BLOCK(raw_data_and_result)
raw_data_and_result1 = raw_data_and_result %>%
mutate(
TOTALFRT_SERV = F_TOTAL/(DT_KCAL/1000),
FRT_SERV = F_SOLID/(DT_KCAL/1000),
VEG_SERV = (V_TOTAL+LEGUMES)/(DT_KCAL/1000),
GREENNBEAN_SERV = (V_DRKGR+LEGUMES)/(DT_KCAL/1000),
TOTALPRO_SERV = (M_MPF+M_EGG+M_NUTSD+M_SOY+(LEGUMES*4))/(DT_KCAL/1000),
SEAPLANTPRO_SERV = (M_FISH_HI+M_FISH_LO+M_SOY+M_NUTSD+(LEGUMES*4))/(DT_KCAL/1000),
WHOLEGRAIN_SERV = G_WHL/(DT_KCAL/1000),
DAIRY_SERV = D_TOTAL/(DT_KCAL/1000),
FATTYACID_SERV = (DT_MFAT + DT_PFAT)/DT_SFAT,
REFINEDGRAIN_SERV = G_NWHL/(DT_KCAL/1000),
SODIUM_SERV = (DT_SODI/1000)/(DT_KCAL/1000),
ADDEDSUGAR_SERV = ((ADD_SUG*4*4) / DT_KCAL)*100,
SATFAT_SERV = ((DT_SFAT*9)/DT_KCAL)*100
)
HEI2015(raw_data_and_result1, RESPONDENTID, DT_KCAL,
TOTALFRT_SERV,
FRT_SERV,
VEG_SERV,
REENNBEAN_SERV,
TOTALPRO_SERV,
SEAPLANTPRO_SERV,
WHOLEGRAIN_SERV,
DAIRY_SERV,
FATTYACID_SERV,
REFINEDGRAIN_SERV,
SODIUM_SERV,
ADDEDSUGAR_SERV,
SATFAT_SER)
HEI2015 = function(SERV_DATA, RESPONDENTID, TOTALKCAL, TOTALFRT_SERV, FRT_SERV, VEG_SERV, GREENNBEAN_SERV, TOTALPRO_SERV,
SEAPLANTPRO_SERV, WHOLEGRAIN_SERV, DAIRY_SERV, FATTYACID_SERV, REFINEDGRAIN_SERV,
SODIUM_SERV, ADDEDSUGAR_SERV, SATFAT_SERV){
##Create variables needed for HEI2015 calculation
HEI2015_MIN = 0
HEI2015_MAX1 = 5
HEI2015_MAX2 = 10
HEI2015_MIN_TOTALFRT_SERV = 0
HEI2015_MAX_TOTALFRT_SERV = 0.8
HEI2015_MIN_FRT_SERV = 0
HEI2015_MAX_FRT_SERV = 0.4
HEI2015_MIN_VEG_SERV = 0
HEI2015_MAX_VEG_SERV = 1.1
HEI2015_MIN_GREENNBEAN_SERV = 0
HEI2015_MAX_GREENNBEAN_SERV = 0.2
HEI2015_MIN_TOTALPRO_SERV = 0
HEI2015_MAX_TOTALPRO_SERV = 2.5
HEI2015_MIN_SEAPLANTPRO_SERV = 0
HEI2015_MAX_SEAPLANTPRO_SERV = 0.8
HEI2015_MIN_WHOLEGRAIN_SERV = 0
HEI2015_MAX_WHOLEGRAIN_SERV = 1.5
HEI2015_MIN_DAIRY_SERV = 0
HEI2015_MAX_DAIRY_SERV = 1.3
HEI2015_MIN_FATTYACID_SERV = 1.2
HEI2015_MAX_FATTYACID_SERV = 2.5
HEI2015_MIN_REFINEDGRAIN_SERV = 4.3
HEI2015_MAX_REFINEDGRAIN_SERV = 1.8
HEI2015_MIN_SODIUM_SERV = 2.0
HEI2015_MAX_SODIUM_SERV = 1.1
HEI2015_MIN_ADDEDSUGAR_SERV = 26
HEI2015_MAX_ADDEDSUGAR_SERV = 6.5
HEI2015_MIN_SATFAT_SERV = 16
HEI2015_MAX_SATFAT_SERV = 8
HEI2015_HEALTHY1 = function(actual, min, max){
case_when(
actual >= max ~ HEI2015_MAX1,
actual <= min ~ HEI2015_MIN,
TRUE ~ HEI2015_MIN+(actual-min)*HEI2015_MAX1/(max-min)
)
}
HEI2015_HEALTHY2 = function(actual, min, max){
case_when(
actual >= max ~ HEI2015_MAX2,
actual <= min ~ HEI2015_MIN,
TRUE ~ HEI2015_MIN+(actual-min)*HEI2015_MAX2/(max-min)
)
}
HEI2015_UNHEALTHY = function(actual, min, max){
case_when(
actual >= min ~ HEI2015_MIN,
actual <= max ~ HEI2015_MAX2,
TRUE ~ HEI2015_MIN+(actual-min)*HEI2015_MAX2/(max-min)
)
}
SERV_DATA=SERV_DATA %>%
mutate(
HEI2015_TOTALFRT = HEI2015_HEALTHY1(TOTALFRT_SERV, HEI2015_MIN_TOTALFRT_SERV, HEI2015_MAX_TOTALFRT_SERV),
HEI2015_FRT = HEI2015_HEALTHY1(FRT_SERV, HEI2015_MIN_FRT_SERV, HEI2015_MAX_FRT_SERV),
HEI2015_VEG = HEI2015_HEALTHY1(VEG_SERV, HEI2015_MIN_VEG_SERV, HEI2015_MAX_VEG_SERV),
HEI2015_GREENNBEAN = HEI2015_HEALTHY1(GREENNBEAN_SERV, HEI2015_MIN_GREENNBEAN_SERV, HEI2015_MAX_GREENNBEAN_SERV),
HEI2015_TOTALPRO = HEI2015_HEALTHY1(TOTALPRO_SERV, HEI2015_MIN_TOTALPRO_SERV, HEI2015_MAX_TOTALPRO_SERV),
HEI2015_SEAPLANTPRO = HEI2015_HEALTHY1(SEAPLANTPRO_SERV, HEI2015_MIN_SEAPLANTPRO_SERV, HEI2015_MAX_SEAPLANTPRO_SERV),
HEI2015_WHOLEGRAIN = HEI2015_HEALTHY2(WHOLEGRAIN_SERV, HEI2015_MIN_WHOLEGRAIN_SERV, HEI2015_MAX_WHOLEGRAIN_SERV),
HEI2015_DAIRY = HEI2015_HEALTHY2(DAIRY_SERV, HEI2015_MIN_DAIRY_SERV, HEI2015_MAX_DAIRY_SERV),
HEI2015_FATTYACID = HEI2015_HEALTHY2(FATTYACID_SERV, HEI2015_MIN_FATTYACID_SERV, HEI2015_MAX_FATTYACID_SERV),
HEI2015_REFINEDGRAIN = HEI2015_UNHEALTHY(REFINEDGRAIN_SERV, HEI2015_MIN_REFINEDGRAIN_SERV, HEI2015_MAX_REFINEDGRAIN_SERV),
HEI2015_SODIUM = HEI2015_UNHEALTHY(SODIUM_SERV, HEI2015_MIN_SODIUM_SERV, HEI2015_MAX_SODIUM_SERV),
HEI2015_ADDEDSUGAR = HEI2015_UNHEALTHY(ADDEDSUGAR_SERV, HEI2015_MIN_ADDEDSUGAR_SERV, HEI2015_MAX_ADDEDSUGAR_SERV),
HEI2015_SATFAT = HEI2015_UNHEALTHY(SATFAT_SERV, HEI2015_MIN_SATFAT_SERV, HEI2015_MAX_SATFAT_SERV),
HEI2015_ALL= HEI2015_TOTALFRT + HEI2015_FRT + HEI2015_VEG + HEI2015_GREENNBEAN +
HEI2015_TOTALPRO + HEI2015_SEAPLANTPRO + HEI2015_WHOLEGRAIN + HEI2015_DAIRY +
HEI2015_FATTYACID + HEI2015_REFINEDGRAIN + HEI2015_SODIUM + HEI2015_ADDEDSUGAR +
HEI2015_SATFAT
)
for(i in 1:length(TOTALKCAL)){
if (TOTALKCAL[i] == 0){
HEI2015_TOTALFRT[i] = 0
HEI2015_FRT[i] = 0
HEI2015_VEG[i] = 0
HEI2015_GREENNBEAN[i] = 0
HEI2015_TOTALPRO[i] = 0
HEI2015_SEAPLANTPRO[i] = 0
HEI2015_WHOLEGRAIN[i] = 0
HEI2015_DAIRY[i] = 0
HEI2015_FATTYACID[i] = 0
HEI2015_REFINEDGRAIN[i] = 0
HEI2015_ADDEDSUGAR[i] = 0
HEI2015_ALL[i] = 0
}
}
SERV_DATA %>%
select(RESPONDENTID, HEI2015_ALL, HEI2015_TOTALFRT, HEI2015_FRT, HEI2015_VEG, HEI2015_GREENNBEAN,
HEI2015_TOTALPRO, HEI2015_SEAPLANTPRO, HEI2015_WHOLEGRAIN, HEI2015_DAIRY,
HEI2015_FATTYACID, HEI2015_REFINEDGRAIN, HEI2015_SODIUM, HEI2015_ADDEDSUGAR,
HEI2015_SATFAT)
}
#Import data
raw_data_path <- "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Data/Dietary data/data-2022-05-03-16-48-28-rand-1807/diet-raw-and-results_cleaned.csv"
raw_data_and_result <- fread(raw_data_path)
DASH_BLOCK(raw_data_and_result)
raw_data_and_result1 = raw_data_and_result %>%
mutate(
TOTALFRT_SERV = F_TOTAL/(DT_KCAL/1000),
FRT_SERV = F_SOLID/(DT_KCAL/1000),
VEG_SERV = (V_TOTAL+LEGUMES)/(DT_KCAL/1000),
GREENNBEAN_SERV = (V_DRKGR+LEGUMES)/(DT_KCAL/1000),
TOTALPRO_SERV = (M_MPF+M_EGG+M_NUTSD+M_SOY+(LEGUMES*4))/(DT_KCAL/1000),
SEAPLANTPRO_SERV = (M_FISH_HI+M_FISH_LO+M_SOY+M_NUTSD+(LEGUMES*4))/(DT_KCAL/1000),
WHOLEGRAIN_SERV = G_WHL/(DT_KCAL/1000),
DAIRY_SERV = D_TOTAL/(DT_KCAL/1000),
FATTYACID_SERV = (DT_MFAT + DT_PFAT)/DT_SFAT,
REFINEDGRAIN_SERV = G_NWHL/(DT_KCAL/1000),
SODIUM_SERV = (DT_SODI/1000)/(DT_KCAL/1000),
ADDEDSUGAR_SERV = ((ADD_SUG*4*4) / DT_KCAL)*100,
SATFAT_SERV = ((DT_SFAT*9)/DT_KCAL)*100
)
HEI2015(raw_data_and_result1, raw_data_and_result1$RESPONDENTID, raw_data_and_result1$DT_KCAL,
raw_data_and_result1$TOTALFRT_SERV,
raw_data_and_result1$FRT_SERV,
raw_data_and_result1$VEG_SERV,
raw_data_and_result1$GREENNBEAN_SERV,
raw_data_and_result1$TOTALPRO_SERV,
raw_data_and_result1$SEAPLANTPRO_SERV,
raw_data_and_result1$WHOLEGRAIN_SERV,
raw_data_and_result1$DAIRY_SERV,
raw_data_and_result1$FATTYACID_SERV,
raw_data_and_result1$REFINEDGRAIN_SERV,
raw_data_and_result1$SODIUM_SERV,
raw_data_and_result1$ADDEDSUGAR_SERV,
raw_data_and_result1$SATFAT_SER)
raw_data_and_result1 = raw_data_and_result %>%
mutate(
VEG_SERV = V_DPYEL + 0.5*V_DRKGR + V_OTHER + V_STARCY + V_TOMATO,
F_BERRIES = foodfreq(STRAWBERRIESFREQ)*foodport(STRAWBERRIESQUAN),
F_WHOLE = F_SOLID - F_BERRIES + F_BERRIES*2,
FRT_SERV = F_WHOLE,
WGRAIN_SERV = G_WHL/0.035274,
NUTSLEG_SERV = (LEGUMES*4) + M_NUTSD + M_SOY,
N3FAT_SERV = (DT_FA205 + DT_FA226)*1000,
PUFA_SERV = (((DT_TOTN6 + DT_TOTN3 - DT_FA205 - DT_FA226)*9)/ DT_KCAL)*100,
SSB_FRTJ_SERV = (GROUP_SUGARYBEVG_TOTAL_GRAMS / 240) + F_JUICE,
REDPROC_MEAT_SERV = (M_FRANK /1.5) + (M_MEAT/4),
TRANS_SERV = ((DT_TRFAT * 9) / DT_KCAL)*100,
ALCOHOL_SERV=A_BEV,
SODIUM_SERV = DT_SODI,
CALCIUM_SERV = DT_CALC,
VITD_SERV = DT_VITD,
CASUP_SERV = SUP_CA,
VITDSUP_SERV = SUP_VITD,
N3FATSUP_SERV = SUP_OM_3*1000
)
AHEI(raw_data_and_result1, raw_data_and_result1$RESPONDENTID,
raw_data_and_result1$NUTSLEG_SERV,
raw_data_and_result1$FRT_SERV,
raw_data_and_result1$VEG_SERV,
raw_data_and_result1$N3FAT_SERV,
raw_data_and_result1$PUFA_SERV,
raw_data_and_result1$SSB_FRTJ_SERV,
raw_data_and_result1$REDPROC_MEAT_SERV,
raw_data_and_result1$TRANS_SERV,
raw_data_and_result1$ALCOHOL_SERV,
raw_data_and_result1$SODIUM_SERV)
#Serving calculation for DASH diet
#Standard food frequency and portion size response code
STD_FOOD_FREQ = c(1, 2, 3, 4, 5, 6, 7, 8, 9)
STD_FREQ_SERV = c(0, 1/90, 1/30, 2.5/30, 1/7, 2/7, 3.5/7, 5.5/7, 1)
STD_FOOD_PORT = c(1, 2, 3, 4)
STD_PORT_SERV = c(0.25, 0.5, 1, 2)
STD_LUNCHMEAT_PORT_SERV = c(1, 2, 3, 4)
STD_HOTDOG_PORT_SERV = c(1, 2, 3)
STD_FOOD_FREQ_DF = data.frame(STD_FOOD_FREQ, STD_FREQ_SERV)
STD_FOOD_PORT_DF= data.frame(STD_FOOD_PORT, STD_PORT_SERV)
#Match participant response food frequency to the standard food frequency response code
YOGURT_FOOD_PORT = c(2, 3)
YOGURT_PORT_SERV = c(0.5, 1)
YOGURT_PORT_DF = data.frame(STD_FOOD_PORT, STD_PORT_SERV)
BUTTERMILK_FOOD_PORT = c(1, 2, 3, 4)
BUTTERMILK_PORT_SERV = c(0.25, 0.5, 1, 2)
BUTTERMILK_PORT_DF = data.frame(STD_FOOD_PORT, STD_PORT_SERV)
raw_data_and_result1 = raw_data_and_result %>%
mutate(
FRT_FRTJ_SERV = F_WHOLE + JUICE100,
VEG_SERV = V_DPYEL + 0.5*V_DRKGR + V_OTHER + V_STARCY + V_TOMATO,
NUTSLEG_SERV = (LEGUMES*4) + M_NUTSD + M_SOY,
WGRAIN_SERV = G_WHL,
LOWF_MILK_SERV = ifelse(MILKTYPE==4,
foodfreq(MILKFREQ) * MILKQUAN,
0),
YOGURT_SERV = (foodfreq(YOGURTONLYFREQ) *
foodport(YOGURTONLYQUAN, reference=YOGURT_PORT_DF)) +
(foodfreq(BUTTERMILKFREQ) *
foodport(BUTTERMILKQUAN, reference=BUTTERMILK_PORT_DF)),
LOWF_ICECREAMFROYO_SERV = ifelse(ICECREAMFROYOTYPE == 2,
foodfreq(ICECREAMFROYOFREQ) *
foodport(ICECREAMFROYOQUAN)*2,
0),
LOWF_CHEESE_SERV = ifelse(CHEESETYPE == 1,
foodfreq(CHEESEFREQ) * CHEESEQUAN,
0),
LOWF_DAIRY_SERV = LOWF_MILK_SERV+YOGURT_SERV+LOWF_ICECREAMFROYO_SERV+LOWF_CHEESE_SERV,
SODIUM_SERV = DT_SODI,
REDPROC_MEAT_SERV = (M_FRANK /1.5) + (M_MEAT/4),
SSB_FRTJ_SERV = (GROUP_SUGARYBEVG_TOTAL_GRAMS / 240) + F_JUICE - JUICE100
)
#Match participant response food frequency to the standard food frequency response code
YOGURT_FOOD_PORT = c(2, 3)
YOGURT_PORT_SERV = c(0.5, 1)
YOGURT_PORT_DF = data.frame(STD_FOOD_PORT, STD_PORT_SERV)
BUTTERMILK_FOOD_PORT = c(1, 2, 3, 4)
BUTTERMILK_PORT_SERV = c(0.25, 0.5, 1, 2)
BUTTERMILK_PORT_DF = data.frame(STD_FOOD_PORT, STD_PORT_SERV)
raw_data_and_result1 = raw_data_and_result %>%
mutate(
F_BERRIES = foodfreq(STRAWBERRIESFREQ)*foodport(STRAWBERRIESQUAN),
F_WHOLE = F_SOLID - F_BERRIES + F_BERRIES*2,
FRT_FRTJ_SERV = F_WHOLE + JUICE100,
VEG_SERV = V_DPYEL + 0.5*V_DRKGR + V_OTHER + V_STARCY + V_TOMATO,
NUTSLEG_SERV = (LEGUMES*4) + M_NUTSD + M_SOY,
WGRAIN_SERV = G_WHL,
LOWF_MILK_SERV = ifelse(MILKTYPE==4,
foodfreq(MILKFREQ) * MILKQUAN,
0),
YOGURT_SERV = (foodfreq(YOGURTONLYFREQ) *
foodport(YOGURTONLYQUAN, reference=YOGURT_PORT_DF)) +
(foodfreq(BUTTERMILKFREQ) *
foodport(BUTTERMILKQUAN, reference=BUTTERMILK_PORT_DF)),
LOWF_ICECREAMFROYO_SERV = ifelse(ICECREAMFROYOTYPE == 2,
foodfreq(ICECREAMFROYOFREQ) *
foodport(ICECREAMFROYOQUAN)*2,
0),
LOWF_CHEESE_SERV = ifelse(CHEESETYPE == 1,
foodfreq(CHEESEFREQ) * CHEESEQUAN,
0),
LOWF_DAIRY_SERV = LOWF_MILK_SERV+YOGURT_SERV+LOWF_ICECREAMFROYO_SERV+LOWF_CHEESE_SERV,
SODIUM_SERV = DT_SODI,
REDPROC_MEAT_SERV = (M_FRANK /1.5) + (M_MEAT/4),
SSB_FRTJ_SERV = (GROUP_SUGARYBEVG_TOTAL_GRAMS / 240) + F_JUICE - JUICE100
)
DASH(SERV_DATA, RESPONDENTID, FRT_FRTJ_SERV, VEG_SERV, NUTSLEG_SERV, WGRAIN_SERV, LOWF_DAIRY_SERV, SODIUM_SERV, REDPROC_MEAT_SERV, SSB_FRTJ_SERV)
DASH(raw_data_and_result1, RESPONDENTID, FRT_FRTJ_SERV, VEG_SERV, NUTSLEG_SERV, WGRAIN_SERV, LOWF_DAIRY_SERV, SODIUM_SERV, REDPROC_MEAT_SERV, SSB_FRTJ_SERV)
DASH(raw_data_and_result1, SERV_DATA$RESPONDENTID, SERV_DATA$FRT_FRTJ_SERV, SERV_DATA$VEG_SERV, SERV_DATA$NUTSLEG_SERV, SERV_DATA$WGRAIN_SERV, SERV_DATA$LOWF_DAIRY_SERV, SERV_DATA$SODIUM_SERV, SERV_DATA$REDPROC_MEAT_SERV, SERV_DATA$SSB_FRTJ_SERV)
#Functions to match actual food frequency and portion to the standards
foodfreq = function(actual, reference=STD_FOOD_FREQ_DF){
reference[match(actual, reference[,1]),2]
}
foodport = function(actual, reference=STD_FOOD_PORT_DF){
reference[match(actual, reference[,1]),2]
}
#Serving calculation for AHEI 2010
raw_data_and_result1 = raw_data_and_result %>%
mutate(
VEG_SERV = V_DPYEL + 0.5*V_DRKGR + V_OTHER + V_STARCY + V_TOMATO,
F_BERRIES = foodfreq(STRAWBERRIESFREQ)*foodport(STRAWBERRIESQUAN),
F_WHOLE = F_SOLID - F_BERRIES + F_BERRIES*2,
FRT_SERV = F_WHOLE,
WGRAIN_SERV = G_WHL/0.035274,
NUTSLEG_SERV = (LEGUMES*4) + M_NUTSD + M_SOY,
N3FAT_SERV = (DT_FA205 + DT_FA226)*1000,
PUFA_SERV = (((DT_TOTN6 + DT_TOTN3 - DT_FA205 - DT_FA226)*9)/ DT_KCAL)*100,
SSB_FRTJ_SERV = (GROUP_SUGARYBEVG_TOTAL_GRAMS / 240) + F_JUICE,
REDPROC_MEAT_SERV = (M_FRANK /1.5) + (M_MEAT/4),
TRANS_SERV = ((DT_TRFAT * 9) / DT_KCAL)*100,
ALCOHOL_SERV=A_BEV,
SODIUM_SERV = DT_SODI,
CALCIUM_SERV = DT_CALC,
VITD_SERV = DT_VITD,
CASUP_SERV = SUP_CA,
VITDSUP_SERV = SUP_VITD,
N3FATSUP_SERV = SUP_OM_3*1000
)
AHEI(raw_data_and_result1, SERV_DATA$RESPONDENTID, SERV_DATA$FRT_FRTJ_SERV, SERV_DATA$VEG_SERV, SERV_DATA$NUTSLEG_SERV, SERV_DATA$WGRAIN_SERV, SERV_DATA$LOWF_DAIRY_SERV, SERV_DATA$SODIUM_SERV, SERV_DATA$REDPROC_MEAT_SERV, SERV_DATA$SSB_FRTJ_SERV)
HEI2015(raw_data_and_result1, SERV_DATA$RESPONDENTID, SERV_DATA$TOTALKCAL, SERV_DATA$TOTALFRT_SERV, SERV_DATA$FRT_SERV, SERV_DATA$VEG_SERV, SERV_DATA$GREENNBEAN_SERV, SERV_DATA$TOTALPRO_SERV,  SERV_DATA$SEAPLANTPRO_SERV, SERV_DATA$WHOLEGRAIN_SERV, SERV_DATA$DAIRY_SERV, SERV_DATA$FATTYACID_SERV, SERV_DATA$REFINEDGRAIN_SERV,  SERV_DATA$SODIUM_SERV, SERV_DATA$ADDEDSUGAR_SERV, SERV_DATA$SATFAT_SERV)
HEI2015(raw_data_and_result1, raw_data_and_result1$RESPONDENTID, raw_data_and_result1$TOTALKCAL,
raw_data_and_result1$TOTALFRT_SERV, raw_data_and_result1$FRT_SERV, raw_data_and_result1$VEG_SERV,
raw_data_and_result1$GREENNBEAN_SERV, raw_data_and_result1$TOTALPRO_SERV,
raw_data_and_result1$SEAPLANTPRO_SERV, raw_data_and_result1$WHOLEGRAIN_SERV,
raw_data_and_result1$DAIRY_SERV, raw_data_and_result1$FATTYACID_SERV, raw_data_and_result1$REFINEDGRAIN_SERV,
raw_data_and_result1$SODIUM_SERV, raw_data_and_result1$ADDEDSUGAR_SERV, raw_data_and_result1$SATFAT_SERV)
#Serving calculation for AHEI 2010
raw_data_and_result1 = raw_data_and_result %>%
mutate(
TOTALFRT_SERV = F_TOTAL/(DT_KCAL/1000),
FRT_SERV = F_SOLID/(DT_KCAL/1000),
VEG_SERV = (V_TOTAL+LEGUMES)/(DT_KCAL/1000),
GREENNBEAN_SERV = (V_DRKGR+LEGUMES)/(DT_KCAL/1000),
TOTALPRO_SERV = (M_MPF+M_EGG+M_NUTSD+M_SOY+(LEGUMES*4))/(DT_KCAL/1000),
SEAPLANTPRO_SERV = (M_FISH_HI+M_FISH_LO+M_SOY+M_NUTSD+(LEGUMES*4))/(DT_KCAL/1000),
WHOLEGRAIN_SERV = G_WHL/(DT_KCAL/1000),
DAIRY_SERV = D_TOTAL/(DT_KCAL/1000),
FATTYACID_SERV = (DT_MFAT + DT_PFAT)/DT_SFAT,
REFINEDGRAIN_SERV = G_NWHL/(DT_KCAL/1000),
SODIUM_SERV = (DT_SODI/1000)/(DT_KCAL/1000),
ADDEDSUGAR_SERV = ((ADD_SUG*4*4) / DT_KCAL)*100,
SATFAT_SERV = ((DT_SFAT*9)/DT_KCAL)*100
)
HEI2015(raw_data_and_result1, raw_data_and_result1$RESPONDENTID, raw_data_and_result1$TOTALKCAL,
raw_data_and_result1$TOTALFRT_SERV, raw_data_and_result1$FRT_SERV, raw_data_and_result1$VEG_SERV,
raw_data_and_result1$GREENNBEAN_SERV, raw_data_and_result1$TOTALPRO_SERV,
raw_data_and_result1$SEAPLANTPRO_SERV, raw_data_and_result1$WHOLEGRAIN_SERV,
raw_data_and_result1$DAIRY_SERV, raw_data_and_result1$FATTYACID_SERV, raw_data_and_result1$REFINEDGRAIN_SERV,
raw_data_and_result1$SODIUM_SERV, raw_data_and_result1$ADDEDSUGAR_SERV, raw_data_and_result1$SATFAT_SERV)
#Score calculation for HEI2015
HEI2015 = function(SERV_DATA, RESPONDENTID, TOTALKCAL, TOTALFRT_SERV, FRT_SERV, VEG_SERV, GREENNBEAN_SERV, TOTALPRO_SERV,
SEAPLANTPRO_SERV, WHOLEGRAIN_SERV, DAIRY_SERV, FATTYACID_SERV, REFINEDGRAIN_SERV,
SODIUM_SERV, ADDEDSUGAR_SERV, SATFAT_SERV){
##Create variables needed for HEI2015 calculation
HEI2015_MIN = 0
HEI2015_MAX1 = 5
HEI2015_MAX2 = 10
HEI2015_MIN_TOTALFRT_SERV = 0
HEI2015_MAX_TOTALFRT_SERV = 0.8
HEI2015_MIN_FRT_SERV = 0
HEI2015_MAX_FRT_SERV = 0.4
HEI2015_MIN_VEG_SERV = 0
HEI2015_MAX_VEG_SERV = 1.1
HEI2015_MIN_GREENNBEAN_SERV = 0
HEI2015_MAX_GREENNBEAN_SERV = 0.2
HEI2015_MIN_TOTALPRO_SERV = 0
HEI2015_MAX_TOTALPRO_SERV = 2.5
HEI2015_MIN_SEAPLANTPRO_SERV = 0
HEI2015_MAX_SEAPLANTPRO_SERV = 0.8
HEI2015_MIN_WHOLEGRAIN_SERV = 0
HEI2015_MAX_WHOLEGRAIN_SERV = 1.5
HEI2015_MIN_DAIRY_SERV = 0
HEI2015_MAX_DAIRY_SERV = 1.3
HEI2015_MIN_FATTYACID_SERV = 1.2
HEI2015_MAX_FATTYACID_SERV = 2.5
HEI2015_MIN_REFINEDGRAIN_SERV = 4.3
HEI2015_MAX_REFINEDGRAIN_SERV = 1.8
HEI2015_MIN_SODIUM_SERV = 2.0
HEI2015_MAX_SODIUM_SERV = 1.1
HEI2015_MIN_ADDEDSUGAR_SERV = 26
HEI2015_MAX_ADDEDSUGAR_SERV = 6.5
HEI2015_MIN_SATFAT_SERV = 16
HEI2015_MAX_SATFAT_SERV = 8
HEI2015_HEALTHY1 = function(actual, min, max){
case_when(
actual >= max ~ HEI2015_MAX1,
actual <= min ~ HEI2015_MIN,
TRUE ~ HEI2015_MIN+(actual-min)*HEI2015_MAX1/(max-min)
)
}
HEI2015_HEALTHY2 = function(actual, min, max){
case_when(
actual >= max ~ HEI2015_MAX2,
actual <= min ~ HEI2015_MIN,
TRUE ~ HEI2015_MIN+(actual-min)*HEI2015_MAX2/(max-min)
)
}
HEI2015_UNHEALTHY = function(actual, min, max){
case_when(
actual >= min ~ HEI2015_MIN,
actual <= max ~ HEI2015_MAX2,
TRUE ~ HEI2015_MIN+(actual-min)*HEI2015_MAX2/(max-min)
)
}
SERV_DATA=SERV_DATA %>%
mutate(
HEI2015_TOTALFRT = HEI2015_HEALTHY1(TOTALFRT_SERV, HEI2015_MIN_TOTALFRT_SERV, HEI2015_MAX_TOTALFRT_SERV),
HEI2015_FRT = HEI2015_HEALTHY1(FRT_SERV, HEI2015_MIN_FRT_SERV, HEI2015_MAX_FRT_SERV),
HEI2015_VEG = HEI2015_HEALTHY1(VEG_SERV, HEI2015_MIN_VEG_SERV, HEI2015_MAX_VEG_SERV),
HEI2015_GREENNBEAN = HEI2015_HEALTHY1(GREENNBEAN_SERV, HEI2015_MIN_GREENNBEAN_SERV, HEI2015_MAX_GREENNBEAN_SERV),
HEI2015_TOTALPRO = HEI2015_HEALTHY1(TOTALPRO_SERV, HEI2015_MIN_TOTALPRO_SERV, HEI2015_MAX_TOTALPRO_SERV),
HEI2015_SEAPLANTPRO = HEI2015_HEALTHY1(SEAPLANTPRO_SERV, HEI2015_MIN_SEAPLANTPRO_SERV, HEI2015_MAX_SEAPLANTPRO_SERV),
HEI2015_WHOLEGRAIN = HEI2015_HEALTHY2(WHOLEGRAIN_SERV, HEI2015_MIN_WHOLEGRAIN_SERV, HEI2015_MAX_WHOLEGRAIN_SERV),
HEI2015_DAIRY = HEI2015_HEALTHY2(DAIRY_SERV, HEI2015_MIN_DAIRY_SERV, HEI2015_MAX_DAIRY_SERV),
HEI2015_FATTYACID = HEI2015_HEALTHY2(FATTYACID_SERV, HEI2015_MIN_FATTYACID_SERV, HEI2015_MAX_FATTYACID_SERV),
HEI2015_REFINEDGRAIN = HEI2015_UNHEALTHY(REFINEDGRAIN_SERV, HEI2015_MIN_REFINEDGRAIN_SERV, HEI2015_MAX_REFINEDGRAIN_SERV),
HEI2015_SODIUM = HEI2015_UNHEALTHY(SODIUM_SERV, HEI2015_MIN_SODIUM_SERV, HEI2015_MAX_SODIUM_SERV),
HEI2015_ADDEDSUGAR = HEI2015_UNHEALTHY(ADDEDSUGAR_SERV, HEI2015_MIN_ADDEDSUGAR_SERV, HEI2015_MAX_ADDEDSUGAR_SERV),
HEI2015_SATFAT = HEI2015_UNHEALTHY(SATFAT_SERV, HEI2015_MIN_SATFAT_SERV, HEI2015_MAX_SATFAT_SERV),
HEI2015_ALL= HEI2015_TOTALFRT + HEI2015_FRT + HEI2015_VEG + HEI2015_GREENNBEAN +
HEI2015_TOTALPRO + HEI2015_SEAPLANTPRO + HEI2015_WHOLEGRAIN + HEI2015_DAIRY +
HEI2015_FATTYACID + HEI2015_REFINEDGRAIN + HEI2015_SODIUM + HEI2015_ADDEDSUGAR +
HEI2015_SATFAT
)
for(i in 1:length(TOTALKCAL)){
if (TOTALKCAL[i] == 0){
HEI2015_TOTALFRT[i] = 0
HEI2015_FRT[i] = 0
HEI2015_VEG[i] = 0
HEI2015_GREENNBEAN[i] = 0
HEI2015_TOTALPRO[i] = 0
HEI2015_SEAPLANTPRO[i] = 0
HEI2015_WHOLEGRAIN[i] = 0
HEI2015_DAIRY[i] = 0
HEI2015_FATTYACID[i] = 0
HEI2015_REFINEDGRAIN[i] = 0
HEI2015_ADDEDSUGAR[i] = 0
HEI2015_ALL[i] = 0
}
}
SERV_DATA %>%
select(RESPONDENTID, HEI2015_ALL, HEI2015_TOTALFRT, HEI2015_FRT, HEI2015_VEG, HEI2015_GREENNBEAN,
HEI2015_TOTALPRO, HEI2015_SEAPLANTPRO, HEI2015_WHOLEGRAIN, HEI2015_DAIRY,
HEI2015_FATTYACID, HEI2015_REFINEDGRAIN, HEI2015_SODIUM, HEI2015_ADDEDSUGAR,
HEI2015_SATFAT)
}
#Serving calculation for AHEI 2010
raw_data_and_result1 = raw_data_and_result %>%
mutate(
TOTALFRT_SERV = F_TOTAL/(DT_KCAL/1000),
FRT_SERV = F_SOLID/(DT_KCAL/1000),
VEG_SERV = (V_TOTAL+LEGUMES)/(DT_KCAL/1000),
GREENNBEAN_SERV = (V_DRKGR+LEGUMES)/(DT_KCAL/1000),
TOTALPRO_SERV = (M_MPF+M_EGG+M_NUTSD+M_SOY+(LEGUMES*4))/(DT_KCAL/1000),
SEAPLANTPRO_SERV = (M_FISH_HI+M_FISH_LO+M_SOY+M_NUTSD+(LEGUMES*4))/(DT_KCAL/1000),
WHOLEGRAIN_SERV = G_WHL/(DT_KCAL/1000),
DAIRY_SERV = D_TOTAL/(DT_KCAL/1000),
FATTYACID_SERV = (DT_MFAT + DT_PFAT)/DT_SFAT,
REFINEDGRAIN_SERV = G_NWHL/(DT_KCAL/1000),
SODIUM_SERV = (DT_SODI/1000)/(DT_KCAL/1000),
ADDEDSUGAR_SERV = ((ADD_SUG*4*4) / DT_KCAL)*100,
SATFAT_SERV = ((DT_SFAT*9)/DT_KCAL)*100
)
HEI2015(raw_data_and_result1, raw_data_and_result1$RESPONDENTID, raw_data_and_result1$TOTALKCAL,
raw_data_and_result1$TOTALFRT_SERV, raw_data_and_result1$FRT_SERV, raw_data_and_result1$VEG_SERV,
raw_data_and_result1$GREENNBEAN_SERV, raw_data_and_result1$TOTALPRO_SERV,
raw_data_and_result1$SEAPLANTPRO_SERV, raw_data_and_result1$WHOLEGRAIN_SERV,
raw_data_and_result1$DAIRY_SERV, raw_data_and_result1$FATTYACID_SERV, raw_data_and_result1$REFINEDGRAIN_SERV,
raw_data_and_result1$SODIUM_SERV, raw_data_and_result1$ADDEDSUGAR_SERV, raw_data_and_result1$SATFAT_SERV)
HEI2015(raw_data_and_result1, raw_data_and_result1$RESPONDENTID, raw_data_and_result1$DT_KCAL,
raw_data_and_result1$TOTALFRT_SERV, raw_data_and_result1$FRT_SERV, raw_data_and_result1$VEG_SERV,
raw_data_and_result1$GREENNBEAN_SERV, raw_data_and_result1$TOTALPRO_SERV,
raw_data_and_result1$SEAPLANTPRO_SERV, raw_data_and_result1$WHOLEGRAIN_SERV,
raw_data_and_result1$DAIRY_SERV, raw_data_and_result1$FATTYACID_SERV, raw_data_and_result1$REFINEDGRAIN_SERV,
raw_data_and_result1$SODIUM_SERV, raw_data_and_result1$ADDEDSUGAR_SERV, raw_data_and_result1$SATFAT_SERV)
library(roxygen2); # Read in the roxygen2 R package
roxygenise();      # Builds the help files
setwd("~/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/dietaryindex")
library(roxygen2); # Read in the roxygen2 R package
roxygenise();      # Builds the help files
roxygenise();
roxygenise();
