SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITD = tryCatch(DR1TVD*0.025, error = function(e) return(NA)),
VITE = DR1TATOC,
ZN = DR1TZINC) %>%
select(SEQN, ALCOHOL, VITB12, VITB6, BCAROTENE,CAFFEINE,CARB,CHOLES,KCAL,TOTALFAT,FIBER,FOLICACID,
IRON,MG,MUFA,NIACIN,N3FAT,N6FAT,PROTEIN,PUFA,RIBOFLAVIN,SATFAT,SE,THIAMIN,
VITA,VITC,VITD,VITE,ZN)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
left_join(DII_STD1, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITD = tryCatch(DR1TVD*0.025, error = function(e) return(NULL)),
VITE = DR1TATOC,
ZN = DR1TZINC) %>%
select(SEQN, ALCOHOL, VITB12, VITB6, BCAROTENE,CAFFEINE,CARB,CHOLES,KCAL,TOTALFAT,FIBER,FOLICACID,
IRON,MG,MUFA,NIACIN,N3FAT,N6FAT,PROTEIN,PUFA,RIBOFLAVIN,SATFAT,SE,THIAMIN,
VITA,VITC,VITD,VITE,ZN)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
left_join(DII_STD1, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITD = tryCatch(DR1TVD*0.025, error = function(e) return(NULL)),
VITE = DR1TATOC,
ZN = DR1TZINC)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
left_join(DII_STD1, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITE = DR1TATOC,
ZN = DR1TZINC)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
left_join(DII_STD1, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
RESULT = DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
print(RESULT, n=100)
DII_STD
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITE = DR1TATOC,
ZN = DR1TZINC)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
left_join(DII_STD, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
RESULT = DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
print(RESULT, n=100)
COHORT %>%
left_join(DII_STD, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
left_join(DII_STD, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
COHORT
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITE = DR1TATOC,
ZN = DR1TZINC)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
inner_join(DII_STD, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
RESULT = DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
print(RESULT, n=100)
COHORT
DII_STD
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITE = DR1TATOC,
ZN = DR1TZINC)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
inner_join(DII_STD, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
RESULT = DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
print(RESULT, n=100)
DII_NHANES_FPED = function(FPED_PATH, NUTRIENT_PATH, DEMO_PATH){
FPED = read_sas(FPED_PATH)
NUTRIENT = read_xpt(NUTRIENT_PATH)
DEMO = read_xpt(DEMO_PATH)
NUTRIENT = NUTRIENT %>%
filter(DR1DRSTZ == 1) %>%
arrange(SEQN)
DEMO = DEMO %>%
filter(RIDAGEYR >= 2) %>%
select(SEQN, RIDAGEYR, RIAGENDR, SDDSRVYR, SDMVPSU, SDMVSTRA) %>%
arrange(SEQN)
FPED = FPED %>%
arrange(SEQN)
COHORT = NUTRIENT %>%
inner_join(DEMO, by = c("SEQN" = "SEQN")) %>%
left_join(FPED, by = c("SEQN" = "SEQN"))
#Serving size calculation for DII
COHORT = COHORT %>%
filter(DR1TKCAL > 0) %>%
mutate(
ALCOHOL = DR1TALCO,
VITB12 = DR1TVB12,
VITB6 = DR1TVB6,
BCAROTENE = DR1TBCAR,
CAFFEINE = DR1TCAFF/1000,
CARB = DR1TCARB,
CHOLES = DR1TCHOL,
KCAL = DR1TKCAL,
TOTALFAT = DR1TTFAT,
FIBER = DR1TFIBE,
FOLICACID = DR1TFA,
IRON = DR1TIRON,
MG = DR1TMAGN,
MUFA = DR1TMFAT,
NIACIN = DR1TNIAC,
N3FAT = DR1TP183 + DR1TP184 + DR1TP205 + DR1TP225 + DR1TP226,
N6FAT = DR1TP183 + DR1TP204,
PROTEIN = DR1TPROT,
PUFA = DR1TPFAT,
RIBOFLAVIN = DR1TVB2,
SATFAT = DR1TSFAT,
SE = DR1TSELE,
THIAMIN = DR1TVB1,
VITA = DR1TVARA,
VITC = DR1TVC,
VITD = tryCatch(DR1TVD*0.025, error = function(e) return(NULL)),
VITE = DR1TATOC,
ZN = DR1TZINC)
COHORT = COHORT %>%
pivot_longer(-SEQN, names_to="Variable", values_to="Unit")
#Score calculation for DII
COHORT %>%
inner_join(DII_STD, by=c("Variable")) %>%
mutate(
Z_SCORE = (Unit.x - Global_mean)/SD,
PERCENTILE = pnorm(Z_SCORE)*2 - 1,
IND_DII_SCORE = PERCENTILE*Overall_inflammatory_score) %>%
group_by(SEQN)%>%
summarize(DII_ALL = sum(IND_DII_SCORE))
}
FPED_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/fped_dr1tot_0506.sas7bdat"
NUTRIENT_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DR1TOT_D.XPT"
DEMO_PATH = "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/Version_control/DEMO_D.XPT"
RESULT = DII_NHANES_FPED(FPED_PATH, NUTRIENT_PATH, DEMO_PATH)
print(RESULT, n=100)
DII_PATH <- "/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Data/Dietary data/DII_NHANES.csv"
DII_STD <- read_csv(DII_PATH)
DII_STD
usethis::use_data(DII_STD, DII_NHANES_FPED)
usethis::use_data(DII_STD, DII_NHANES_FPED, overwrite = TRUE)
load("/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/dietaryindex/data/DII_NHANES_FPED.rda")
load("/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/dietaryindex/data/DII_STD.rda")
usethis::use_data(DII_STD, overwrite = TRUE)
load("/Users/yan/Desktop/Emory University - Ph.D./Research rotation/Microbiome research/Diet score/dietaryindex_package/dietaryindex/data/DII_STD.rda")
